<!DOCTYPE html>
<html>
<head>
	<title>Visual</title>
	<script src="js/jquery.min.js"></script>
	<script src="js/Chart.bundle.js"></script>
	<script src="js/utils.js"></script>
	<link rel="stylesheet" type="text/css" href="css/index.css">
</head>
<body>
	<div id="canvas-holder" class='pie'>
		<p class="title">Packages Count</p>
        <canvas id="chart-area" />
    </div>
</body>
<script type="text/javascript">
	var color = ['rgb(255,99,132)', 'rgb(255,159,64)', 'rgb(255,205,86)', 'rgb(75,192,192)', 'rgb(54,162,235)', 'rgb(153,102,255)', 'rgb(201,203,207)'];
    window.onload = function() {
		$.get('/GetPackages', function(data){
			var config = {
				type: 'pie',
		        data: {
		            datasets: [{
		                data: [],
		                backgroundColor: []
		            }],
		        	labels: [
					],
				},
				options: {
				}
	        }
	        for (var i=0; i<Math.min(data.length, 20); i++){
	        	config['data']['datasets'][0]['data'].push(data[i]['count']);
	        	config['data']['datasets'][0]['backgroundColor'].push(color[i%7]);
	        	config['data']['labels'].push(data[i]['_id']);
	        }
	        console.log(config);
	        var ctx = document.getElementById("chart-area").getContext("2d");
			window.myPie = new Chart(ctx, config);
		});
    };
</script>
</html>